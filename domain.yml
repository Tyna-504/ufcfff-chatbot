version: '3.1'
session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true

intents:
- affirm
- deny
- goodbye
- greet
- thankyou
- chitchat_mercedes
- bot_challenge
- bot_query
- buy_car
- inform
- stop
- ask_body_type
- ask_engine
- ask_fuel
- ask_transmission
- query_model_class
- query_model
- booktest
- out_of_scope

entities:
- body_type
- engine
- fuel
- transmission
- model_class_name

forms:
  car_form:
    required_slots:
    - body_type
    - engine
    - fuel
    - transmission
  model_form:
    required_slots:
    - model_name
  booktest_model_form:
    required_slots:
    - booktest_model_name
    - booktest_location

slots:
  body_type: #slot 1
    type: categorical
    values:
    - saloon
    - SUV
    - hatchback
    - estate
    - coupe
    - cabriolet
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: body_type
  engine: #slot 2
    type: categorical
    values:
    - combustion engine
    - electric
    - mild hybrid
    - plug-in hybrid
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: engine 
  fuel: #slot 3
    type: categorical
    values:
    - diesel
    - petrol
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: fuel
  transmission: #slot 4
    type: categorical
    values:
    - automatic
    - manual
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: transmission
  model_name: #slot 5
    type: text
    influence_conversation: true
    mappings:
    - type: from_text
      conditions:
        - active_loop: model_form
          requested_slot: model_name
  booktest_model_name: #slot 6
    type: text
    influence_conversation: true
    mappings:
    - type: from_text
      conditions:
        - active_loop: booktest_model_form
          requested_slot: booktest_model_name
  booktest_location: #slot 7
    type: text
    influence_conversation: true
    mappings:
    - type: from_text
      conditions:
        - active_loop: booktest_model_form
          requested_slot: booktest_location

responses:
  utter_greet:
  - text: Hello, I am a virtual Mercedes-Benz car selling assitant. How can I help you?
  utter_goodbye:
  - text: Goodbye, thank you for using the Mercedes chatbot!
  utter_yourwelcome:
  - text: You are welcome. Let me know if I can help you with anything else.
  utter_iamabot:
  - text: I am a bot here to support you with communicating with Mercedes-Benz UK. I am powered by Rasa.
  utter_capability:
  - text: I am a virtual assitant helping you choose the correct Mercedes model for you. There are currently over 100 models in production.
  utter_submit:
  - text: Thank you, your preferences have been recorded!
  utter_car_slots:
    - condition:  # a conditional response
        - type: slot
          name: engine
          value: "electric"
      text: "I am searching for an electric {body_type} Mercedes."
    - condition:
        - type: slot
          name: engine
          value: "combustion engine"
      text: "I am searching for a {body_type} Mercedes with {fuel} {engine} and {transmission} transmission."
    - condition:
        - type: slot
          name: engine
          value: "mild hybrid"
      text: "I am searching for a {body_type} Mercedes with {fuel} {engine} engine and {transmission} transmission."
    - condition:
      - type: slot
        name: engine
        value: "plug-in hybrid"
      text: "I am searching for a {body_type} Mercedes with {fuel} {engine} engine and {transmission} transmission."     
  utter_ask_continue:
  - text: Are you sure you want to stop the form?
  utter_ask_car_form_body_type:
  - text: What body type are you looking for?
  utter_ask_car_form_engine:
  - text: What engine are you looking for?
  utter_ask_car_form_fuel:
  - text: What fuel type are you looking for?
  utter_ask_car_form_transmission:
  - text: What transmission are you looking for?
  utter_ask_model_name:
  - text: Please provide the full model name you would like to know more about.
  utter_ask_booktest_model_name:
  - text: Please provide the full model name you would like to book a test drive for.
  utter_ask_booktest_location:
  - text: Please provide the city where you would like to book a test drive.
  utter_booktest:
  - text: "The {booktest_model_name} is available for a test drive in your city. Please call the following number to book a test drive/: 0080097777777"
  utter_out_of_scope:
  - text: I apologise, this feature is not available at the moment. I will do my best to help you with that in the future. Is there anything else I can do?

actions:
- utter_ask_car_form_body_type
- utter_ask_car_form_fuel
- utter_ask_car_form_engine
- utter_ask_car_form_transmission
- utter_ask_continue
- utter_capability
- utter_car_slots
- utter_goodbye
- utter_greet
- utter_iamabot
- utter_submit
- validate_car_form
- action_query_car
- action_dispatch_car_explanations
- action_query_model_class
- action_query_model
- action_reset_slot
- action_chitchat_mercedes